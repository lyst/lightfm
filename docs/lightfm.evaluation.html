

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Model evaluation &mdash; LightFM 1.9 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="LightFM 1.9 documentation" href="index.html"/>
        <link rel="next" title="Datasets" href="datasets.html"/>
        <link rel="prev" title="LightFM" href="lightfm.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html" class="icon icon-home"> LightFM
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="home.html">Home</a><ul>
<li class="toctree-l2"><a class="reference internal" href="home.html#quickstart">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="home.html#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="home.html#pypi">PyPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="home.html#using-with-docker">Using with Docker</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="home.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="home.html#examples">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="home.html#development">Development</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="lightfm.html">LightFM model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Model evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/movielens_implicit.html">Movielens implicit feedback recommender</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/movielens_implicit.html#implicit-feedback">Implicit feedback</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/movielens_implicit.html#getting-the-data">Getting the data</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/movielens_implicit.html#fitting-models">Fitting models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/learning_schedules.html">Learning rate schedules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/learning_schedules.html#preliminaries">Preliminaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/learning_schedules.html#experiment">Experiment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/hybrid_crossvalidated.html">Item cold-start: recommending StackExchange questions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/hybrid_crossvalidated.html#a-pure-collaborative-filtering-model">A pure collaborative filtering model</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/hybrid_crossvalidated.html#a-hybrid-model">A hybrid model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/hybrid_crossvalidated.html#bonus-tag-embeddings">Bonus: tag embeddings</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">LightFM</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Model evaluation</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/lightfm.evaluation.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="module-lightfm.evaluation">
<span id="model-evaluation"></span><h1>Model evaluation<a class="headerlink" href="#module-lightfm.evaluation" title="Permalink to this headline">¶</a></h1>
<p>Module containing evaluation functions suitable for judging the performance of a fitted
LightFM model.</p>
<dl class="function">
<dt id="lightfm.evaluation.precision_at_k">
<code class="descclassname">lightfm.evaluation.</code><code class="descname">precision_at_k</code><span class="sig-paren">(</span><em>model</em>, <em>test_interactions</em>, <em>train_interactions=None</em>, <em>k=10</em>, <em>user_features=None</em>, <em>item_features=None</em>, <em>preserve_rows=False</em>, <em>num_threads=1</em><span class="sig-paren">)</span><a class="headerlink" href="#lightfm.evaluation.precision_at_k" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure the precision at k metric for a model: the fraction of known positives in the first k
positions of the ranked list of results.
A perfect score is 1.0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>model</strong> (<em>LightFM instance</em>) &#8211; the model to be evaluated</li>
<li><strong>test_interactions</strong> (<em>np.float32 csr_matrix of shape [n_users, n_items]</em>) &#8211; Non-zero entries representing known positives in the evaluation set.</li>
<li><strong>train_interactions</strong> (<em>np.float32 csr_matrix of shape [n_users, n_items], optional</em>) &#8211; Non-zero entries representing known positives in the train set. These
will be omitted from the score calulations to avoid re-recommending
known positives.</li>
<li><strong>k</strong> (<em>integer, optional</em>) &#8211; The k parameter.</li>
<li><strong>user_features</strong> (<em>np.float32 csr_matrix of shape [n_users, n_user_features], optional</em>) &#8211; Each row contains that user&#8217;s weights over features.</li>
<li><strong>item_features</strong> (<em>np.float32 csr_matrix of shape [n_items, n_item_features], optional</em>) &#8211; Each row contains that item&#8217;s weights over features.</li>
<li><strong>preserve_rows</strong> (<em>boolean, optional</em>) &#8211; When False (default), the number of rows in the output will be equal to
the number of users with interactions in the evaluation set. When True,
the number of rows in the output will be equal to the number of users.</li>
<li><strong>num_threads</strong> (<em>int, optional</em>) &#8211; Number of parallel computation threads to use. Should
not be higher than the number of physical cores.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Numpy array containing precision&#64;k scores for each user. If there are no interactions for a given
user the returned precision will be 0.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array of shape [n_users with interactions or n_users,]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lightfm.evaluation.auc_score">
<code class="descclassname">lightfm.evaluation.</code><code class="descname">auc_score</code><span class="sig-paren">(</span><em>model</em>, <em>test_interactions</em>, <em>train_interactions=None</em>, <em>user_features=None</em>, <em>item_features=None</em>, <em>preserve_rows=False</em>, <em>num_threads=1</em><span class="sig-paren">)</span><a class="headerlink" href="#lightfm.evaluation.auc_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure the ROC AUC metric for a model: the probability that a randomly chosen positive
example has a higher score than a randomly chosen negative example.
A perfect score is 1.0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>model</strong> (<em>LightFM instance</em>) &#8211; the model to be evaluated</li>
<li><strong>test_interactions</strong> (<em>np.float32 csr_matrix of shape [n_users, n_items]</em>) &#8211; Non-zero entries representing known positives in the evaluation set.</li>
<li><strong>train_interactions</strong> (<em>np.float32 csr_matrix of shape [n_users, n_items], optional</em>) &#8211; Non-zero entries representing known positives in the train set. These
will be omitted from the score calulations to avoid re-recommending
known positives.</li>
<li><strong>user_features</strong> (<em>np.float32 csr_matrix of shape [n_users, n_user_features], optional</em>) &#8211; Each row contains that user&#8217;s weights over features.</li>
<li><strong>item_features</strong> (<em>np.float32 csr_matrix of shape [n_items, n_item_features], optional</em>) &#8211; Each row contains that item&#8217;s weights over features.</li>
<li><strong>preserve_rows</strong> (<em>boolean, optional</em>) &#8211; When False (default), the number of rows in the output will be equal to
the number of users with interactions in the evaluation set. When True,
the number of rows in the output will be equal to the number of users.</li>
<li><strong>num_threads</strong> (<em>int, optional</em>) &#8211; Number of parallel computation threads to use. Should
not be higher than the number of physical cores.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Numpy array containing AUC scores for each user. If there are no interactions for a given
user the returned AUC will be 0.5.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array of shape [n_users with interactions or n_users,]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lightfm.evaluation.reciprocal_rank">
<code class="descclassname">lightfm.evaluation.</code><code class="descname">reciprocal_rank</code><span class="sig-paren">(</span><em>model</em>, <em>test_interactions</em>, <em>train_interactions=None</em>, <em>user_features=None</em>, <em>item_features=None</em>, <em>preserve_rows=False</em>, <em>num_threads=1</em><span class="sig-paren">)</span><a class="headerlink" href="#lightfm.evaluation.reciprocal_rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure the reciprocal rank metric for a model: 1 / the rank of the highest ranked positive example.
A perfect score is 1.0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>model</strong> (<em>LightFM instance</em>) &#8211; the model to be evaluated</li>
<li><strong>test_interactions</strong> (<em>np.float32 csr_matrix of shape [n_users, n_items]</em>) &#8211; Non-zero entries representing known positives in the evaluation set.</li>
<li><strong>train_interactions</strong> (<em>np.float32 csr_matrix of shape [n_users, n_items], optional</em>) &#8211; Non-zero entries representing known positives in the train set. These
will be omitted from the score calulations to avoid re-recommending
known positives.</li>
<li><strong>user_features</strong> (<em>np.float32 csr_matrix of shape [n_users, n_user_features], optional</em>) &#8211; Each row contains that user&#8217;s weights over features.</li>
<li><strong>item_features</strong> (<em>np.float32 csr_matrix of shape [n_items, n_item_features], optional</em>) &#8211; Each row contains that item&#8217;s weights over features.</li>
<li><strong>preserve_rows</strong> (<em>boolean, optional</em>) &#8211; When False (default), the number of rows in the output will be equal to
the number of users with interactions in the evaluation set. When True,
the number of rows in the output will be equal to the number of users.</li>
<li><strong>num_threads</strong> (<em>int, optional</em>) &#8211; Number of parallel computation threads to use. Should
not be higher than the number of physical cores.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Numpy array containing reciprocal rank scores for each user. If there are no interactions for a given
user the returned value will be 0.0.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array of shape [n_users with interactions or n_users,]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="datasets.html" class="btn btn-neutral float-right" title="Datasets" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lightfm.html" class="btn btn-neutral" title="LightFM" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Lyst (Maciej Kula).
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>